<header
  class="bg-[#F9F9F9] flex justify-between items-center shadow-md sticky top-0 z-30 h-[72px] md:h-[104px] px-4 md:px-8">

  <!-- Menú Hamburguesa + Logo -->
  <div class="flex items-center space-x-2">
    <button class="md:hidden" (click)="toggleMenu()" aria-label="Abrir/Cerrar menú">
      <svg *ngIf="!menuOpen" class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
      <svg *ngIf="menuOpen" class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>

    <a routerLink="/">
      <img src="assets/imagenes/logo.svg" alt="Logo" class="h-8 w-auto md:h-10" />
    </a>
  </div>

  <!-- NAV -->
  <nav class="flex items-center space-x-4 md:space-x-8 text-gray-600">
    <!-- Buscador -->
    <div class="hidden md:block relative w-[220px] lg:w-[284px] h-10">
      <input type="text" placeholder="Busca la sección"
        class="w-full h-full p-2 pl-10 rounded-lg text-sm bg-white border border-gray-300 focus:outline-none focus:ring-1 focus:ring-blue-500 transition">
      <svg class="w-5 h-5 absolute left-2.5 top-1/2 transform -translate-y-1/2 text-[#929292]" fill="none"
        stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg>
    </div>

    <!-- Notificaciones -->
    <div class="relative">
      <button (click)="toggleNotifications()"
        class="relative h-6 w-6 flex items-center justify-center notification-toggle">
        <img src="assets/imagenes/Bell-Notification.svg" alt="Notification" class="h-5 w-auto" />
        <div *ngIf="hasUnreadNotifications"
          class="absolute -top-[1px] -right-[2px] h-2.5 w-2.5 bg-[#A10303] rounded-full border-2 border-white"></div>
      </button>

      <div *ngIf="notificationsOpen"
        class="notification-panel absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50">
        <div class="p-3">
          <h3 class="text-sm text-center font-bold text-gray-700">Notificaciones</h3>
        </div>

        <div class="max-h-[650px] overflow-y-auto">
          <div *ngFor="let notif of notifications" class="px-4 py-3 border-b border-gray-100">
            <div class="flex items-start space-x-3 relative">
              <div
                class="h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center text-xs font-bold text-gray-600 relative">
                <img src="assets/imagenes/user-icon.svg" alt="user" class="h-8 w-8 rounded-full bg-gray-200" />
                <span *ngIf="notif.unread"
                  class="absolute -top-1 -right-1 h-2.5 w-2.5 bg-[#A10303] rounded-full border-2 border-white"></span>
              </div>
              <div class="flex-1">
                <p class="text-sm text-gray-800 leading-snug">
                  <strong>{{ notif.cliente }}</strong> {{ notif.mensaje }}
                </p>
                <div class="mt-2 flex space-x-2">
                  <button (click)="handleAction('Cancelar', notif.id)"
                    class="flex-1 border border-gray-300 rounded-lg py-1 text-xs text-gray-700 hover:bg-gray-100">
                    Cancelar
                  </button>
                  <button (click)="handleAction('Crear', notif.id)"
                    class="flex-1 bg-[#212B36] text-white rounded-lg py-1 text-xs hover:bg-[#1A222B]">
                    Crear
                  </button>
                </div>
                <p class="mt-1 text-xs text-gray-400">{{ notif.hora }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Avatar -->
    <button
      class="h-8 w-8 flex items-center justify-center rounded-full bg-[#E0E0E0] text-sm text-black font-semibold hover:bg-gray-300 transition">
      JM
    </button>
  </nav>
</header>

<div *ngIf="menuOpen"
  class="fixed top-[72px] md:hidden left-0 w-full bg-white shadow-lg z-20 h-[calc(100vh-72px)] overflow-y-auto">
  <nav class="flex flex-col py-4 px-4 space-y-1">
    <div *ngFor="let item of menuItems">
      <a (click)="selectMenu(item)" [ngClass]="{
          'font-semibold text-gray-900': item.open && item.subItems,
          'bg-[#F0EDFB] font-semibold': item.selected && !item.subItems
        }"
        class="flex justify-between items-center p-2 rounded-lg text-gray-700 hover:bg-gray-100 transition cursor-pointer">
        <span>{{ item.name }}</span>
        <svg *ngIf="item.subItems" [ngClass]="{'rotate-180': item.open}"
          class="w-4 h-4 text-gray-500 transition-transform duration-300" fill="none" stroke="currentColor"
          viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
        </svg>
      </a>

      <div *ngIf="item.open && item.subItems" class="ml-4 py-1 flex flex-col space-y-0.5">
        <a *ngFor="let subItem of item.subItems" (click)="selectSubMenu(item, subItem)"
          [ngClass]="{'bg-[#F0EDFB] font-semibold': subItem.selected}"
          class="flex items-center p-2 text-gray-600 rounded-lg hover:bg-gray-100 transition cursor-pointer">
          {{ subItem.name }}
        </a>
      </div>
    </div>

    <!-- Logout -->
    <div class="mt-4 border-t border-gray-300 pt-4">
      <button (click)="logout()"
        class="flex items-center text-[#A10303] hover:bg-gray-100 p-2 rounded-lg transition w-full text-left font-medium">
        <img src="assets/imagenes/log-out-icon.svg" alt="Logout" class="w-5 h-5 mr-2" />
        <span>Salir</span>
      </button>
    </div>
  </nav>
</div>